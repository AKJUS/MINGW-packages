--- a/lib/runtime/CMakeLists.txt
+++ b/lib/runtime/CMakeLists.txt
@@ -182,7 +182,7 @@
 endif ()
 
 
-if (NOT WIN32)
+if (NOT MSVC)
   add_flangrt_library(flang_rt.runtime STATIC SHARED
     ${sources}
     LINK_LIBRARIES ${Backtrace_LIBRARY}
--- a/lib/runtime/command.cpp
+++ b/lib/runtime/command.cpp
@@ -19,6 +19,7 @@
 #ifdef _WIN32
 #include "flang/Common/windows-include.h"
 #include <direct.h>
+#include <process.h>
 #define getcwd _getcwd
 #define unlink _unlink
 #define PATH_MAX MAX_PATH
